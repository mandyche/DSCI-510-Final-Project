



### Dataset milestone
import streamlit as st

st.title('Datasets (Milestone1)')
st.write('Dataset1: Weatherstack API; This Weatherstack API was built to deliver accurate weather data for any application and use case, from real-time and historical weather information all the way to 14-day weather forecasts.')
st.write('Dataset2: Yahoo Finance; This website contains accurate and timely data on basic stock information like price, volume, market cap, earnings dividends, basic ratios, analyst ratings and news.')
st.write('Dataset3: BBC News; This website lists news/articles related to financial planning, stock markets, and personal finance rankings.')


### DFinal research 

st.title('Research Question #4-8')
#Answering questions on the rubric
st.write('4. What did you set out to study?')
st.write('I chose to study identifying relationship between financial news sentiment, weather patterns and stock performance by observing what financial news talks about corresponding to the weather pattern in California on a specific date and use that information to observe a trend to see if there is a significant influence on the SPY stock (Note that the changes between here and my mileston1 is that I decided to use BBC business/financial news content instead of US money news).')

st.write('5. What did you Discover/what were your conclusions?')
st.write('From my graphical analysis, I noticed there is a significant pattern between news title impact and stock performance. However, the relationship between weather and stock performance is not as significant as between news & stock. For example, I noticed that when the news titles are rated as positive, the closing prices tend to go up. When the news title is negative, the closing prices tend to go down. On the other side, sunny and rainy weather do not make significant difference on stock performance.')

st.write('6. What difficulties did you have in completing the project')
st.write('The first difficulty I had was that at first I could not scrpae US Money news, which is why I changed to scrape BBC news. The second difficulty I had was that establishing graph for comparing stock performance with different weather patterns. Because I had to create pandas data frame to merge the information together before start comparing, I personally thought some pandas language was hard to debug.')

st.write('7. What skills did you wish you had while you were doing the project?')
st.write('During my project work, I wish I had a fluent data engineering skill in data cleaning. I think data cleaning is essential for handling messy, real-world datasets efficiently. I was not able to handle/clean large missing data such as data imputation for missing closing price for one of the date throughout 2023 SPY stock performance.')

st.write('8. What would you do “next” to expand or augment the project?')
st.write('After I found out if weather has influences on stock, I would like to know if it is because weather has directly influence on stock or if it is because weather has influenced the news article, and stock is affected only because of news article content (difference in difference).')


### Home
import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

# Load my dataframe
spy = pd.read_csv("spy_2023_pricing.csv")

# Ensure 'Date' column is in datetime format
spy['Date'] = pd.to_datetime(spy['Date'])

# Specify "plot", so get a line plot
def plot_graph(data, title):
    plt.plot(data['Date'], data['Closing Price'])
    plt.xlabel('Date')
    plt.ylabel('Closing Price')
    plt.title('SPY Closing')
    st.set_option('deprecation.showPyplotGlobalUse', False) #disable warning by disabling the config option
    st.pyplot()


# Sidebar filtered buttons
selected_weather = st.sidebar.radio("Select Weather:", ['All', 'Sunny', 'Rainy'])
selected_impact = st.sidebar.radio("Select Impact:", ['All', 'Positive', 'Negative'])

# Filter DataFrame based on selected options
if selected_weather == 'All' and selected_impact == 'All':
    filtered_spy = spy
elif selected_weather == 'All':
    filtered_spy = spy[spy['News Rating'] == selected_impact.capitalize()]
elif selected_impact == 'All':
    filtered_spy = spy[spy['Weather'] == selected_weather]
else:
    filtered_spy = spy[(spy['Weather'] == selected_weather) & (spy['News Rating'] == selected_impact.capitalize())]

# Visualize my dataframe in the Streamlit app
st.write(filtered_spy)

# Plot the line graph with filtered data
plot_graph(filtered_spy, f"Stock Price - Weather: {selected_weather}, News Rating: {selected_impact}")






st.write('Hello! Welcome to my research project about discovering the correlational relationship between weather, financial news, and stock performance. In this project, my ultimate goal is to investigate the potential relationship between financial news sentiment, weather patterns, and stock performance. I scraped all of 2023 BBC business news title and put them into chatgpt asking for the impact rating (if there are 7 news that day, 4 out of 7 news titles considered as positive, then the overall rating for the news during that day is rated as positive). I also simplified the weather rating into rainy and sunny only. If the weather that day is not rainy(cloudy or partly cloudy), it is considered as sunny. By analyzing these datasets and compare with SPY stock performance, I hope I could provide valuable insights for investors and analysts in understanding market dynamics.')
